# Generate an optimized minimal working HTML with Farcaster autoconnect and Base enforcement

html_content = """<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Based Pasta Ristorante — dApp</title>
<style>
body{margin:0;font-family:sans-serif;background:#02122c;color:#eef5ff;display:flex;justify-content:center;align-items:center;min-height:100vh}
.card{width:95vw;max-width:800px;background:#0b2f73;padding:20px;border-radius:14px}
button{padding:14px 18px;border-radius:10px;border:none;font-weight:700;cursor:pointer}
.big{width:100%;margin-top:12px}
.ghost{opacity:.5}
#status{margin-top:10px;font-size:14px}
</style>
</head>
<body>
<div class="card">
<h2>🍝 Based Pasta Ristorante</h2>
<select id="dish">
<option value="Pasta">🍝 Pasta</option>
<option value="Spaghetti">🥓 Spaghetti</option>
</select>
<br><br>
<input id="message" type="text" maxlength="64" placeholder="Your note"/>
<br><br>
<input id="tip" type="number" step="0.0001" min="0" placeholder="0 ETH"/>
<br><br>
<button id="press" class="big">🍽️ Order (on-chain)</button>
<div id="status">Checking environment…</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/ethers@6.13.2/dist/ethers.umd.min.js"></script>

<script type="module">
import { sdk } from 'https://esm.sh/@farcaster/miniapp-sdk@latest';

const CONTRACT = "0x18b1119706520839E2aa632191331A94A673F00c";
const ABI = [{"inputs":[{"internalType":"string","name":"message_","type":"string"}],"name":"press","outputs":[],"stateMutability":"payable","type":"function"}];
const CHAIN = "0x2105"; // Base

let signer, provider, contract;

async function ready(){
  try{
    await sdk.actions.ready({ disableNativeGestures:true });
  }catch{}
}

async function autoconnect(){
  try{
    const ethProv = await sdk.wallet.getEthereumProvider();
    await ethProv.request({ method:"wallet_switchEthereumChain", params:[{ chainId:CHAIN }]});
    provider = new ethers.BrowserProvider(ethProv);
    signer = await provider.getSigner();
    contract = new ethers.Contract(CONTRACT, ABI, signer);
    document.getElementById("status").textContent = "✅ Connected";
  }catch(e){
    document.getElementById("status").textContent = "⚠️ Not connected";
  }
}

document.getElementById("press").onclick = async()=>{
  if(!contract) return alert("Wallet not connected");
  const msg = document.getElementById("message").value;
  const tip = document.getElementById("tip").value || "0";
  const tx = await contract.press(msg,{ value: ethers.parseEther(tip)});
  document.getElementById("status").textContent = "Sent…";
};

window.addEventListener("load", async()=>{
  await ready();
  await autoconnect();
});
</script>
</body>
</html>
"""

import os
path = "/mnt/data/basedrestaurant/index.html"
with open(path, "w") as f:
    f.write(html_content)

path
